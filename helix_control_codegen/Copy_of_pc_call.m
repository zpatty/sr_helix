%% simulate puppet segment
clear
close all

L0 = 0.19;



N = 4;
q0 = zeros(1 + (N-1)*3,1);
q0(2) = 0.000;
q0(5) = 0.000;
q0(8) = 0.01;
dq0 = zeros(1 + (N-1)*3,1);
r = 0.03;
d = 0.0395;
kb = 0;
ks = 0;
bb = 0;
bs = 0;
bm = 0;
e = L0/1000;
segment_mass = 0.071;
med_plates = 0.036;
end_plate = 0.023;
m = 2*segment_mass + 2 * med_plates;
kps = 0;
kpb = 0;
km = 0;
Kp = diag([km, repmat([kpb, kpb, kps],1,N-1)]);
Dm = 0.0;
Ds = 0;
KD = diag([Dm, repmat([Ds, Ds, Ds],1,N-1)]);
qhist = [q0];
tauhist = [];
chist = [];
Kpx = 50.0;
KDx = 50.0;
xd = [0.1;0.0;0.2];
dxd = [0;0;0];
dxr = [0;0;0];


conv_pcc = 1;
conv_motor = 1;
[tau, tau_r, x, M, C, A, cq] = helix_controller(q0,dq0,q0,q0,q0,d,m,r,kb,ks,bb,bs,bm,L0,Kp,KD,Kpx, KDx, xd, dxd, dxr, conv_pcc,conv_motor);
C_test = C_calc(q0,dq0,1/4*m*r^2, 1/4*m*r^2, 1/2*m*r^2,L0,r,m);
C
% Cdq = C_test(1:4,1:4)*dq0
q = q0;
gr = 9.81;
m2 = m;
th = q(1);
dx1 = 0.000000000000001;
dy1 = q(3);
dL1 = q(4);
dx2 = 0.000000000000001;
dy2 = q(6);
dL2 = q(7);
dx3 = q(8);
dy3 = 0.00000000000000;
dL3 = q(10);
Fg = [                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                0;
                                                                                   (d*dx1*gr*m2*sin((dx1^2 + dy1^2)^(1/2)/d)*(L0/2 - dL1))/(dx1^2 + dy1^2)^(3/2) - gr*m2*((dx1*cos((dx1^2 + dy1^2)^(1/2)/d)*(L0 - dL1))/(dx1^2 + dy1^2) - (d*dx1*sin((dx1^2 + dy1^2)^(1/2)/d)*(L0 - dL1))/(dx1^2 + dy1^2)^(3/2) - (d*dy3*(cos((dx3^2 + dy3^2)^(1/2)/d) - 1)*(L0/2 - dL3)*((dx1*dy1*sin((dx1^2 + dy1^2)^(1/2)/d)*(dx2^2 + dy2^2*cos((dx2^2 + dy2^2)^(1/2)/d)))/((dx1^2 + dy1^2)^(3/2)*(dx2^2 + dy2^2)) - (dx2*dy2*sin((dx1^2 + dy1^2)^(1/2)/d)*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)) + (dx1*dy2*sin((dx1^2 + dy1^2)^(1/2)/d)*sin((dx2^2 + dy2^2)^(1/2)/d))/(d*(dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)^(1/2)) - (dx1*dy1*cos((dx1^2 + dy1^2)^(1/2)/d)*(dx2^2 + dy2^2*cos((dx2^2 + dy2^2)^(1/2)/d)))/(d*(dx1^2 + dy1^2)*(dx2^2 + dy2^2)) + (dx1^2*dx2*dy2*sin((dx1^2 + dy1^2)^(1/2)/d)*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1))/((dx1^2 + dy1^2)^(3/2)*(dx2^2 + dy2^2)) - (dx1^2*dx2*dy2*cos((dx1^2 + dy1^2)^(1/2)/d)*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1))/(d*(dx1^2 + dy1^2)*(dx2^2 + dy2^2))))/(dx3^2 + dy3^2) - (dx1*sin((dx1^2 + dy1^2)^(1/2)/d)*sin((dx2^2 + dy2^2)^(1/2)/d)*(L0 - dL2))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)^(1/2)) + (d*dx3*(cos((dx3^2 + dy3^2)^(1/2)/d) - 1)*(L0/2 - dL3)*((sin((dx1^2 + dy1^2)^(1/2)/d)*(dy2^2 + dx2^2*cos((dx2^2 + dy2^2)^(1/2)/d)))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)) - (dx1^2*sin((dx1^2 + dy1^2)^(1/2)/d)*(dy2^2 + dx2^2*cos((dx2^2 + dy2^2)^(1/2)/d)))/((dx1^2 + dy1^2)^(3/2)*(dx2^2 + dy2^2)) + (dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)*(dy2^2 + dx2^2*cos((dx2^2 + dy2^2)^(1/2)/d)))/(d*(dx1^2 + dy1^2)*(dx2^2 + dy2^2)) - (dx1*dx2*sin((dx1^2 + dy1^2)^(1/2)/d)*sin((dx2^2 + dy2^2)^(1/2)/d))/(d*(dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)^(1/2)) - (dx1*dx2*dy1*dy2*sin((dx1^2 + dy1^2)^(1/2)/d)*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1))/((dx1^2 + dy1^2)^(3/2)*(dx2^2 + dy2^2)) + (dx1*dx2*dy1*dy2*cos((dx1^2 + dy1^2)^(1/2)/d)*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1))/(d*(dx1^2 + dy1^2)*(dx2^2 + dy2^2))))/(dx3^2 + dy3^2) - (d*sin((dx3^2 + dy3^2)^(1/2)/d)*(L0/2 - dL3)*(dx2*sin((dx1^2 + dy1^2)^(1/2)/d)*sin((dx2^2 + dy2^2)^(1/2)/d) + (dx1*cos((dx2^2 + dy2^2)^(1/2)/d)*sin((dx1^2 + dy1^2)^(1/2)/d)*(dx2^2 + dy2^2)^(1/2))/d - (dx1*cos((dx1^2 + dy1^2)^(1/2)/d)*cos((dx2^2 + dy2^2)^(1/2)/d)*(dx2^2 + dy2^2)^(1/2))/(dx1^2 + dy1^2)^(1/2) + (dx1^2*dx2*cos((dx1^2 + dy1^2)^(1/2)/d)*sin((dx2^2 + dy2^2)^(1/2)/d))/(d*(dx1^2 + dy1^2)^(1/2)) + (dx1*dy1*dy2*cos((dx1^2 + dy1^2)^(1/2)/d)*sin((dx2^2 + dy2^2)^(1/2)/d))/(d*(dx1^2 + dy1^2)^(1/2))))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)^(1/2)*(dx3^2 + dy3^2)^(1/2)) + (d*dx2*sin((dx1^2 + dy1^2)^(1/2)/d)*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1)*(L0 - dL2))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)) + (dx1^2*dx2*cos((dx1^2 + dy1^2)^(1/2)/d)*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1)*(L0 - dL2))/((dx1^2 + dy1^2)*(dx2^2 + dy2^2)) + (d*dx1*sin((dx3^2 + dy3^2)^(1/2)/d)*(L0/2 - dL3)*(dx1*dx2*sin((dx1^2 + dy1^2)^(1/2)/d)*sin((dx2^2 + dy2^2)^(1/2)/d) - cos((dx1^2 + dy1^2)^(1/2)/d)*cos((dx2^2 + dy2^2)^(1/2)/d)*(dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)^(1/2) + dy1*dy2*sin((dx1^2 + dy1^2)^(1/2)/d)*sin((dx2^2 + dy2^2)^(1/2)/d)))/((dx1^2 + dy1^2)^(3/2)*(dx2^2 + dy2^2)^(1/2)*(dx3^2 + dy3^2)^(1/2)) + (dx1*dy1*dy2*cos((dx1^2 + dy1^2)^(1/2)/d)*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1)*(L0 - dL2))/((dx1^2 + dy1^2)*(dx2^2 + dy2^2)) - (d*dx1^2*dx2*sin((dx1^2 + dy1^2)^(1/2)/d)*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1)*(L0 - dL2))/((dx1^2 + dy1^2)^(3/2)*(dx2^2 + dy2^2)) - (d*dx1*dy1*dy2*sin((dx1^2 + dy1^2)^(1/2)/d)*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1)*(L0 - dL2))/((dx1^2 + dy1^2)^(3/2)*(dx2^2 + dy2^2))) - (dx1*gr*m2*cos((dx1^2 + dy1^2)^(1/2)/d)*(L0/2 - dL1))/(dx1^2 + dy1^2) - gr*m2*((dx1*cos((dx1^2 + dy1^2)^(1/2)/d)*(L0 - dL1))/(dx1^2 + dy1^2) - (d*dx1*sin((dx1^2 + dy1^2)^(1/2)/d)*(L0 - dL1))/(dx1^2 + dy1^2)^(3/2) - (dx1*sin((dx1^2 + dy1^2)^(1/2)/d)*sin((dx2^2 + dy2^2)^(1/2)/d)*(L0/2 - dL2))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)^(1/2)) + (d*dx2*sin((dx1^2 + dy1^2)^(1/2)/d)*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1)*(L0/2 - dL2))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)) + (dx1^2*dx2*cos((dx1^2 + dy1^2)^(1/2)/d)*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1)*(L0/2 - dL2))/((dx1^2 + dy1^2)*(dx2^2 + dy2^2)) - (d*dx1^2*dx2*sin((dx1^2 + dy1^2)^(1/2)/d)*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1)*(L0/2 - dL2))/((dx1^2 + dy1^2)^(3/2)*(dx2^2 + dy2^2)) + (dx1*dy1*dy2*cos((dx1^2 + dy1^2)^(1/2)/d)*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1)*(L0/2 - dL2))/((dx1^2 + dy1^2)*(dx2^2 + dy2^2)) - (d*dx1*dy1*dy2*sin((dx1^2 + dy1^2)^(1/2)/d)*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1)*(L0/2 - dL2))/((dx1^2 + dy1^2)^(3/2)*(dx2^2 + dy2^2)));
                                                                                   (d*dy1*gr*m2*sin((dx1^2 + dy1^2)^(1/2)/d)*(L0/2 - dL1))/(dx1^2 + dy1^2)^(3/2) - gr*m2*((dy1*cos((dx1^2 + dy1^2)^(1/2)/d)*(L0 - dL1))/(dx1^2 + dy1^2) - (d*dy1*sin((dx1^2 + dy1^2)^(1/2)/d)*(L0 - dL1))/(dx1^2 + dy1^2)^(3/2) - (d*dx3*(cos((dx3^2 + dy3^2)^(1/2)/d) - 1)*(L0/2 - dL3)*((dx1*dy1*sin((dx1^2 + dy1^2)^(1/2)/d)*(dy2^2 + dx2^2*cos((dx2^2 + dy2^2)^(1/2)/d)))/((dx1^2 + dy1^2)^(3/2)*(dx2^2 + dy2^2)) - (dx2*dy2*sin((dx1^2 + dy1^2)^(1/2)/d)*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)) + (dx2*dy1*sin((dx1^2 + dy1^2)^(1/2)/d)*sin((dx2^2 + dy2^2)^(1/2)/d))/(d*(dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)^(1/2)) - (dx1*dy1*cos((dx1^2 + dy1^2)^(1/2)/d)*(dy2^2 + dx2^2*cos((dx2^2 + dy2^2)^(1/2)/d)))/(d*(dx1^2 + dy1^2)*(dx2^2 + dy2^2)) + (dx2*dy1^2*dy2*sin((dx1^2 + dy1^2)^(1/2)/d)*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1))/((dx1^2 + dy1^2)^(3/2)*(dx2^2 + dy2^2)) - (dx2*dy1^2*dy2*cos((dx1^2 + dy1^2)^(1/2)/d)*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1))/(d*(dx1^2 + dy1^2)*(dx2^2 + dy2^2))))/(dx3^2 + dy3^2) - (dy1*sin((dx1^2 + dy1^2)^(1/2)/d)*sin((dx2^2 + dy2^2)^(1/2)/d)*(L0 - dL2))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)^(1/2)) + (d*dy3*(cos((dx3^2 + dy3^2)^(1/2)/d) - 1)*(L0/2 - dL3)*((sin((dx1^2 + dy1^2)^(1/2)/d)*(dx2^2 + dy2^2*cos((dx2^2 + dy2^2)^(1/2)/d)))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)) - (dy1^2*sin((dx1^2 + dy1^2)^(1/2)/d)*(dx2^2 + dy2^2*cos((dx2^2 + dy2^2)^(1/2)/d)))/((dx1^2 + dy1^2)^(3/2)*(dx2^2 + dy2^2)) + (dy1^2*cos((dx1^2 + dy1^2)^(1/2)/d)*(dx2^2 + dy2^2*cos((dx2^2 + dy2^2)^(1/2)/d)))/(d*(dx1^2 + dy1^2)*(dx2^2 + dy2^2)) - (dy1*dy2*sin((dx1^2 + dy1^2)^(1/2)/d)*sin((dx2^2 + dy2^2)^(1/2)/d))/(d*(dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)^(1/2)) - (dx1*dx2*dy1*dy2*sin((dx1^2 + dy1^2)^(1/2)/d)*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1))/((dx1^2 + dy1^2)^(3/2)*(dx2^2 + dy2^2)) + (dx1*dx2*dy1*dy2*cos((dx1^2 + dy1^2)^(1/2)/d)*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1))/(d*(dx1^2 + dy1^2)*(dx2^2 + dy2^2))))/(dx3^2 + dy3^2) - (d*sin((dx3^2 + dy3^2)^(1/2)/d)*(L0/2 - dL3)*(dy2*sin((dx1^2 + dy1^2)^(1/2)/d)*sin((dx2^2 + dy2^2)^(1/2)/d) + (dy1*cos((dx2^2 + dy2^2)^(1/2)/d)*sin((dx1^2 + dy1^2)^(1/2)/d)*(dx2^2 + dy2^2)^(1/2))/d - (dy1*cos((dx1^2 + dy1^2)^(1/2)/d)*cos((dx2^2 + dy2^2)^(1/2)/d)*(dx2^2 + dy2^2)^(1/2))/(dx1^2 + dy1^2)^(1/2) + (dy1^2*dy2*cos((dx1^2 + dy1^2)^(1/2)/d)*sin((dx2^2 + dy2^2)^(1/2)/d))/(d*(dx1^2 + dy1^2)^(1/2)) + (dx1*dx2*dy1*cos((dx1^2 + dy1^2)^(1/2)/d)*sin((dx2^2 + dy2^2)^(1/2)/d))/(d*(dx1^2 + dy1^2)^(1/2))))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)^(1/2)*(dx3^2 + dy3^2)^(1/2)) + (d*dy2*sin((dx1^2 + dy1^2)^(1/2)/d)*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1)*(L0 - dL2))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)) + (dy1^2*dy2*cos((dx1^2 + dy1^2)^(1/2)/d)*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1)*(L0 - dL2))/((dx1^2 + dy1^2)*(dx2^2 + dy2^2)) + (d*dy1*sin((dx3^2 + dy3^2)^(1/2)/d)*(L0/2 - dL3)*(dx1*dx2*sin((dx1^2 + dy1^2)^(1/2)/d)*sin((dx2^2 + dy2^2)^(1/2)/d) - cos((dx1^2 + dy1^2)^(1/2)/d)*cos((dx2^2 + dy2^2)^(1/2)/d)*(dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)^(1/2) + dy1*dy2*sin((dx1^2 + dy1^2)^(1/2)/d)*sin((dx2^2 + dy2^2)^(1/2)/d)))/((dx1^2 + dy1^2)^(3/2)*(dx2^2 + dy2^2)^(1/2)*(dx3^2 + dy3^2)^(1/2)) + (dx1*dx2*dy1*cos((dx1^2 + dy1^2)^(1/2)/d)*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1)*(L0 - dL2))/((dx1^2 + dy1^2)*(dx2^2 + dy2^2)) - (d*dy1^2*dy2*sin((dx1^2 + dy1^2)^(1/2)/d)*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1)*(L0 - dL2))/((dx1^2 + dy1^2)^(3/2)*(dx2^2 + dy2^2)) - (d*dx1*dx2*dy1*sin((dx1^2 + dy1^2)^(1/2)/d)*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1)*(L0 - dL2))/((dx1^2 + dy1^2)^(3/2)*(dx2^2 + dy2^2))) - (dy1*gr*m2*cos((dx1^2 + dy1^2)^(1/2)/d)*(L0/2 - dL1))/(dx1^2 + dy1^2) - gr*m2*((dy1*cos((dx1^2 + dy1^2)^(1/2)/d)*(L0 - dL1))/(dx1^2 + dy1^2) - (d*dy1*sin((dx1^2 + dy1^2)^(1/2)/d)*(L0 - dL1))/(dx1^2 + dy1^2)^(3/2) - (dy1*sin((dx1^2 + dy1^2)^(1/2)/d)*sin((dx2^2 + dy2^2)^(1/2)/d)*(L0/2 - dL2))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)^(1/2)) + (d*dy2*sin((dx1^2 + dy1^2)^(1/2)/d)*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1)*(L0/2 - dL2))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)) + (dy1^2*dy2*cos((dx1^2 + dy1^2)^(1/2)/d)*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1)*(L0/2 - dL2))/((dx1^2 + dy1^2)*(dx2^2 + dy2^2)) - (d*dy1^2*dy2*sin((dx1^2 + dy1^2)^(1/2)/d)*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1)*(L0/2 - dL2))/((dx1^2 + dy1^2)^(3/2)*(dx2^2 + dy2^2)) + (dx1*dx2*dy1*cos((dx1^2 + dy1^2)^(1/2)/d)*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1)*(L0/2 - dL2))/((dx1^2 + dy1^2)*(dx2^2 + dy2^2)) - (d*dx1*dx2*dy1*sin((dx1^2 + dy1^2)^(1/2)/d)*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1)*(L0/2 - dL2))/((dx1^2 + dy1^2)^(3/2)*(dx2^2 + dy2^2)));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          (3*d*gr*m2*sin((dx1^2 + dy1^2)^(1/2)/d))/(dx1^2 + dy1^2)^(1/2);
gr*m2*((d*dx2*cos((dx1^2 + dy1^2)^(1/2)/d)*sin((dx2^2 + dy2^2)^(1/2)/d)*(L0/2 - dL2))/(dx2^2 + dy2^2)^(3/2) - (dx2*cos((dx1^2 + dy1^2)^(1/2)/d)*cos((dx2^2 + dy2^2)^(1/2)/d)*(L0/2 - dL2))/(dx2^2 + dy2^2) - (d*dx1*sin((dx1^2 + dy1^2)^(1/2)/d)*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1)*(L0/2 - dL2))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)) + (dx1*dx2^2*sin((dx1^2 + dy1^2)^(1/2)/d)*sin((dx2^2 + dy2^2)^(1/2)/d)*(L0/2 - dL2))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)^(3/2)) + (2*d*dx1*dx2^2*sin((dx1^2 + dy1^2)^(1/2)/d)*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1)*(L0/2 - dL2))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)^2) + (dx2*dy1*dy2*sin((dx1^2 + dy1^2)^(1/2)/d)*sin((dx2^2 + dy2^2)^(1/2)/d)*(L0/2 - dL2))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)^(3/2)) + (2*d*dx2*dy1*dy2*sin((dx1^2 + dy1^2)^(1/2)/d)*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1)*(L0/2 - dL2))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)^2)) + gr*m2*((d*dy3*(cos((dx3^2 + dy3^2)^(1/2)/d) - 1)*(L0/2 - dL3)*((dx2*dy2*cos((dx1^2 + dy1^2)^(1/2)/d)*sin((dx2^2 + dy2^2)^(1/2)/d))/(dx2^2 + dy2^2)^(3/2) - (dy1*sin((dx1^2 + dy1^2)^(1/2)/d)*(2*dx2 - (dx2*dy2^2*sin((dx2^2 + dy2^2)^(1/2)/d))/(d*(dx2^2 + dy2^2)^(1/2))))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)) + (2*dx2*dy1*sin((dx1^2 + dy1^2)^(1/2)/d)*(dx2^2 + dy2^2*cos((dx2^2 + dy2^2)^(1/2)/d)))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)^2) - (dx1*dy2*sin((dx1^2 + dy1^2)^(1/2)/d)*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)) - (dx2*dy2*cos((dx1^2 + dy1^2)^(1/2)/d)*cos((dx2^2 + dy2^2)^(1/2)/d))/(d*(dx2^2 + dy2^2)) + (2*dx1*dx2^2*dy2*sin((dx1^2 + dy1^2)^(1/2)/d)*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)^2) + (dx1*dx2^2*dy2*sin((dx1^2 + dy1^2)^(1/2)/d)*sin((dx2^2 + dy2^2)^(1/2)/d))/(d*(dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)^(3/2))))/(dx3^2 + dy3^2) - (dx2*cos((dx1^2 + dy1^2)^(1/2)/d)*cos((dx2^2 + dy2^2)^(1/2)/d)*(L0 - dL2))/(dx2^2 + dy2^2) + (d*dx2*cos((dx1^2 + dy1^2)^(1/2)/d)*sin((dx2^2 + dy2^2)^(1/2)/d)*(L0 - dL2))/(dx2^2 + dy2^2)^(3/2) - (d*dx3*(cos((dx3^2 + dy3^2)^(1/2)/d) - 1)*(L0/2 - dL3)*((cos((dx1^2 + dy1^2)^(1/2)/d)*sin((dx2^2 + dy2^2)^(1/2)/d))/(dx2^2 + dy2^2)^(1/2) - (dx2^2*cos((dx1^2 + dy1^2)^(1/2)/d)*sin((dx2^2 + dy2^2)^(1/2)/d))/(dx2^2 + dy2^2)^(3/2) + (dx1*sin((dx1^2 + dy1^2)^(1/2)/d)*(2*dx2*cos((dx2^2 + dy2^2)^(1/2)/d) - (dx2^3*sin((dx2^2 + dy2^2)^(1/2)/d))/(d*(dx2^2 + dy2^2)^(1/2))))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)) + (dx2^2*cos((dx1^2 + dy1^2)^(1/2)/d)*cos((dx2^2 + dy2^2)^(1/2)/d))/(d*(dx2^2 + dy2^2)) - (2*dx1*dx2*sin((dx1^2 + dy1^2)^(1/2)/d)*(dy2^2 + dx2^2*cos((dx2^2 + dy2^2)^(1/2)/d)))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)^2) + (dy1*dy2*sin((dx1^2 + dy1^2)^(1/2)/d)*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)) - (2*dx2^2*dy1*dy2*sin((dx1^2 + dy1^2)^(1/2)/d)*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)^2) - (dx2^2*dy1*dy2*sin((dx1^2 + dy1^2)^(1/2)/d)*sin((dx2^2 + dy2^2)^(1/2)/d))/(d*(dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)^(3/2))))/(dx3^2 + dy3^2) + (d*sin((dx3^2 + dy3^2)^(1/2)/d)*(L0/2 - dL3)*(dx1*sin((dx1^2 + dy1^2)^(1/2)/d)*sin((dx2^2 + dy2^2)^(1/2)/d) + (dx2*cos((dx1^2 + dy1^2)^(1/2)/d)*sin((dx2^2 + dy2^2)^(1/2)/d)*(dx1^2 + dy1^2)^(1/2))/d - (dx2*cos((dx1^2 + dy1^2)^(1/2)/d)*cos((dx2^2 + dy2^2)^(1/2)/d)*(dx1^2 + dy1^2)^(1/2))/(dx2^2 + dy2^2)^(1/2) + (dx1*dx2^2*cos((dx2^2 + dy2^2)^(1/2)/d)*sin((dx1^2 + dy1^2)^(1/2)/d))/(d*(dx2^2 + dy2^2)^(1/2)) + (dx2*dy1*dy2*cos((dx2^2 + dy2^2)^(1/2)/d)*sin((dx1^2 + dy1^2)^(1/2)/d))/(d*(dx2^2 + dy2^2)^(1/2))))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)^(1/2)*(dx3^2 + dy3^2)^(1/2)) - (d*dx1*sin((dx1^2 + dy1^2)^(1/2)/d)*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1)*(L0 - dL2))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)) + (dx1*dx2^2*sin((dx1^2 + dy1^2)^(1/2)/d)*sin((dx2^2 + dy2^2)^(1/2)/d)*(L0 - dL2))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)^(3/2)) + (dx2*dy1*dy2*sin((dx1^2 + dy1^2)^(1/2)/d)*sin((dx2^2 + dy2^2)^(1/2)/d)*(L0 - dL2))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)^(3/2)) - (d*dx2*sin((dx3^2 + dy3^2)^(1/2)/d)*(L0/2 - dL3)*(dx1*dx2*sin((dx1^2 + dy1^2)^(1/2)/d)*sin((dx2^2 + dy2^2)^(1/2)/d) - cos((dx1^2 + dy1^2)^(1/2)/d)*cos((dx2^2 + dy2^2)^(1/2)/d)*(dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)^(1/2) + dy1*dy2*sin((dx1^2 + dy1^2)^(1/2)/d)*sin((dx2^2 + dy2^2)^(1/2)/d)))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)^(3/2)*(dx3^2 + dy3^2)^(1/2)) + (2*d*dx1*dx2^2*sin((dx1^2 + dy1^2)^(1/2)/d)*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1)*(L0 - dL2))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)^2) + (2*d*dx2*dy1*dy2*sin((dx1^2 + dy1^2)^(1/2)/d)*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1)*(L0 - dL2))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)^2));
gr*m2*((d*dy2*cos((dx1^2 + dy1^2)^(1/2)/d)*sin((dx2^2 + dy2^2)^(1/2)/d)*(L0/2 - dL2))/(dx2^2 + dy2^2)^(3/2) - (dy2*cos((dx1^2 + dy1^2)^(1/2)/d)*cos((dx2^2 + dy2^2)^(1/2)/d)*(L0/2 - dL2))/(dx2^2 + dy2^2) - (d*dy1*sin((dx1^2 + dy1^2)^(1/2)/d)*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1)*(L0/2 - dL2))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)) + (dy1*dy2^2*sin((dx1^2 + dy1^2)^(1/2)/d)*sin((dx2^2 + dy2^2)^(1/2)/d)*(L0/2 - dL2))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)^(3/2)) + (2*d*dy1*dy2^2*sin((dx1^2 + dy1^2)^(1/2)/d)*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1)*(L0/2 - dL2))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)^2) + (dx1*dx2*dy2*sin((dx1^2 + dy1^2)^(1/2)/d)*sin((dx2^2 + dy2^2)^(1/2)/d)*(L0/2 - dL2))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)^(3/2)) + (2*d*dx1*dx2*dy2*sin((dx1^2 + dy1^2)^(1/2)/d)*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1)*(L0/2 - dL2))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)^2)) + gr*m2*((d*dx3*(cos((dx3^2 + dy3^2)^(1/2)/d) - 1)*(L0/2 - dL3)*((dx2*dy2*cos((dx1^2 + dy1^2)^(1/2)/d)*sin((dx2^2 + dy2^2)^(1/2)/d))/(dx2^2 + dy2^2)^(3/2) - (dx1*sin((dx1^2 + dy1^2)^(1/2)/d)*(2*dy2 - (dx2^2*dy2*sin((dx2^2 + dy2^2)^(1/2)/d))/(d*(dx2^2 + dy2^2)^(1/2))))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)) + (2*dx1*dy2*sin((dx1^2 + dy1^2)^(1/2)/d)*(dy2^2 + dx2^2*cos((dx2^2 + dy2^2)^(1/2)/d)))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)^2) - (dx2*dy1*sin((dx1^2 + dy1^2)^(1/2)/d)*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)) - (dx2*dy2*cos((dx1^2 + dy1^2)^(1/2)/d)*cos((dx2^2 + dy2^2)^(1/2)/d))/(d*(dx2^2 + dy2^2)) + (2*dx2*dy1*dy2^2*sin((dx1^2 + dy1^2)^(1/2)/d)*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)^2) + (dx2*dy1*dy2^2*sin((dx1^2 + dy1^2)^(1/2)/d)*sin((dx2^2 + dy2^2)^(1/2)/d))/(d*(dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)^(3/2))))/(dx3^2 + dy3^2) - (dy2*cos((dx1^2 + dy1^2)^(1/2)/d)*cos((dx2^2 + dy2^2)^(1/2)/d)*(L0 - dL2))/(dx2^2 + dy2^2) + (d*dy2*cos((dx1^2 + dy1^2)^(1/2)/d)*sin((dx2^2 + dy2^2)^(1/2)/d)*(L0 - dL2))/(dx2^2 + dy2^2)^(3/2) - (d*dy3*(cos((dx3^2 + dy3^2)^(1/2)/d) - 1)*(L0/2 - dL3)*((cos((dx1^2 + dy1^2)^(1/2)/d)*sin((dx2^2 + dy2^2)^(1/2)/d))/(dx2^2 + dy2^2)^(1/2) - (dy2^2*cos((dx1^2 + dy1^2)^(1/2)/d)*sin((dx2^2 + dy2^2)^(1/2)/d))/(dx2^2 + dy2^2)^(3/2) + (dy1*sin((dx1^2 + dy1^2)^(1/2)/d)*(2*dy2*cos((dx2^2 + dy2^2)^(1/2)/d) - (dy2^3*sin((dx2^2 + dy2^2)^(1/2)/d))/(d*(dx2^2 + dy2^2)^(1/2))))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)) + (dy2^2*cos((dx1^2 + dy1^2)^(1/2)/d)*cos((dx2^2 + dy2^2)^(1/2)/d))/(d*(dx2^2 + dy2^2)) - (2*dy1*dy2*sin((dx1^2 + dy1^2)^(1/2)/d)*(dx2^2 + dy2^2*cos((dx2^2 + dy2^2)^(1/2)/d)))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)^2) + (dx1*dx2*sin((dx1^2 + dy1^2)^(1/2)/d)*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)) - (2*dx1*dx2*dy2^2*sin((dx1^2 + dy1^2)^(1/2)/d)*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)^2) - (dx1*dx2*dy2^2*sin((dx1^2 + dy1^2)^(1/2)/d)*sin((dx2^2 + dy2^2)^(1/2)/d))/(d*(dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)^(3/2))))/(dx3^2 + dy3^2) + (d*sin((dx3^2 + dy3^2)^(1/2)/d)*(L0/2 - dL3)*(dy1*sin((dx1^2 + dy1^2)^(1/2)/d)*sin((dx2^2 + dy2^2)^(1/2)/d) + (dy2*cos((dx1^2 + dy1^2)^(1/2)/d)*sin((dx2^2 + dy2^2)^(1/2)/d)*(dx1^2 + dy1^2)^(1/2))/d - (dy2*cos((dx1^2 + dy1^2)^(1/2)/d)*cos((dx2^2 + dy2^2)^(1/2)/d)*(dx1^2 + dy1^2)^(1/2))/(dx2^2 + dy2^2)^(1/2) + (dy1*dy2^2*cos((dx2^2 + dy2^2)^(1/2)/d)*sin((dx1^2 + dy1^2)^(1/2)/d))/(d*(dx2^2 + dy2^2)^(1/2)) + (dx1*dx2*dy2*cos((dx2^2 + dy2^2)^(1/2)/d)*sin((dx1^2 + dy1^2)^(1/2)/d))/(d*(dx2^2 + dy2^2)^(1/2))))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)^(1/2)*(dx3^2 + dy3^2)^(1/2)) - (d*dy1*sin((dx1^2 + dy1^2)^(1/2)/d)*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1)*(L0 - dL2))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)) + (dy1*dy2^2*sin((dx1^2 + dy1^2)^(1/2)/d)*sin((dx2^2 + dy2^2)^(1/2)/d)*(L0 - dL2))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)^(3/2)) + (dx1*dx2*dy2*sin((dx1^2 + dy1^2)^(1/2)/d)*sin((dx2^2 + dy2^2)^(1/2)/d)*(L0 - dL2))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)^(3/2)) - (d*dy2*sin((dx3^2 + dy3^2)^(1/2)/d)*(L0/2 - dL3)*(dx1*dx2*sin((dx1^2 + dy1^2)^(1/2)/d)*sin((dx2^2 + dy2^2)^(1/2)/d) - cos((dx1^2 + dy1^2)^(1/2)/d)*cos((dx2^2 + dy2^2)^(1/2)/d)*(dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)^(1/2) + dy1*dy2*sin((dx1^2 + dy1^2)^(1/2)/d)*sin((dx2^2 + dy2^2)^(1/2)/d)))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)^(3/2)*(dx3^2 + dy3^2)^(1/2)) + (2*d*dy1*dy2^2*sin((dx1^2 + dy1^2)^(1/2)/d)*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1)*(L0 - dL2))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)^2) + (2*d*dx1*dx2*dy2*sin((dx1^2 + dy1^2)^(1/2)/d)*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1)*(L0 - dL2))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)^2));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               2*gr*m2*((d*cos((dx1^2 + dy1^2)^(1/2)/d)*sin((dx2^2 + dy2^2)^(1/2)/d))/(dx2^2 + dy2^2)^(1/2) + (d*dx1*dx2*sin((dx1^2 + dy1^2)^(1/2)/d)*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)) + (d*dy1*dy2*sin((dx1^2 + dy1^2)^(1/2)/d)*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           gr*m2*((dx3^2*sin((dx3^2 + dy3^2)^(1/2)/d)*(L0/2 - dL3)*((dx2*cos((dx1^2 + dy1^2)^(1/2)/d)*sin((dx2^2 + dy2^2)^(1/2)/d))/(dx2^2 + dy2^2)^(1/2) + (dx1*sin((dx1^2 + dy1^2)^(1/2)/d)*(dy2^2 + dx2^2*cos((dx2^2 + dy2^2)^(1/2)/d)))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)) + (dx2*dy1*dy2*sin((dx1^2 + dy1^2)^(1/2)/d)*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2))))/(dx3^2 + dy3^2)^(3/2) - (d*(cos((dx3^2 + dy3^2)^(1/2)/d) - 1)*(L0/2 - dL3)*((dx2*cos((dx1^2 + dy1^2)^(1/2)/d)*sin((dx2^2 + dy2^2)^(1/2)/d))/(dx2^2 + dy2^2)^(1/2) + (dx1*sin((dx1^2 + dy1^2)^(1/2)/d)*(dy2^2 + dx2^2*cos((dx2^2 + dy2^2)^(1/2)/d)))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)) + (dx2*dy1*dy2*sin((dx1^2 + dy1^2)^(1/2)/d)*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2))))/(dx3^2 + dy3^2) + (2*d*dx3^2*(cos((dx3^2 + dy3^2)^(1/2)/d) - 1)*(L0/2 - dL3)*((dx2*cos((dx1^2 + dy1^2)^(1/2)/d)*sin((dx2^2 + dy2^2)^(1/2)/d))/(dx2^2 + dy2^2)^(1/2) + (dx1*sin((dx1^2 + dy1^2)^(1/2)/d)*(dy2^2 + dx2^2*cos((dx2^2 + dy2^2)^(1/2)/d)))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)) + (dx2*dy1*dy2*sin((dx1^2 + dy1^2)^(1/2)/d)*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2))))/(dx3^2 + dy3^2)^2 + (dx3*dy3*sin((dx3^2 + dy3^2)^(1/2)/d)*(L0/2 - dL3)*((dy2*cos((dx1^2 + dy1^2)^(1/2)/d)*sin((dx2^2 + dy2^2)^(1/2)/d))/(dx2^2 + dy2^2)^(1/2) + (dy1*sin((dx1^2 + dy1^2)^(1/2)/d)*(dx2^2 + dy2^2*cos((dx2^2 + dy2^2)^(1/2)/d)))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)) + (dx1*dx2*dy2*sin((dx1^2 + dy1^2)^(1/2)/d)*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2))))/(dx3^2 + dy3^2)^(3/2) + (2*d*dx3*dy3*(cos((dx3^2 + dy3^2)^(1/2)/d) - 1)*(L0/2 - dL3)*((dy2*cos((dx1^2 + dy1^2)^(1/2)/d)*sin((dx2^2 + dy2^2)^(1/2)/d))/(dx2^2 + dy2^2)^(1/2) + (dy1*sin((dx1^2 + dy1^2)^(1/2)/d)*(dx2^2 + dy2^2*cos((dx2^2 + dy2^2)^(1/2)/d)))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)) + (dx1*dx2*dy2*sin((dx1^2 + dy1^2)^(1/2)/d)*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2))))/(dx3^2 + dy3^2)^2 + (dx3*cos((dx3^2 + dy3^2)^(1/2)/d)*(L0/2 - dL3)*(dx1*dx2*sin((dx1^2 + dy1^2)^(1/2)/d)*sin((dx2^2 + dy2^2)^(1/2)/d) - cos((dx1^2 + dy1^2)^(1/2)/d)*cos((dx2^2 + dy2^2)^(1/2)/d)*(dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)^(1/2) + dy1*dy2*sin((dx1^2 + dy1^2)^(1/2)/d)*sin((dx2^2 + dy2^2)^(1/2)/d)))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)^(1/2)*(dx3^2 + dy3^2)) - (d*dx3*sin((dx3^2 + dy3^2)^(1/2)/d)*(L0/2 - dL3)*(dx1*dx2*sin((dx1^2 + dy1^2)^(1/2)/d)*sin((dx2^2 + dy2^2)^(1/2)/d) - cos((dx1^2 + dy1^2)^(1/2)/d)*cos((dx2^2 + dy2^2)^(1/2)/d)*(dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)^(1/2) + dy1*dy2*sin((dx1^2 + dy1^2)^(1/2)/d)*sin((dx2^2 + dy2^2)^(1/2)/d)))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)^(1/2)*(dx3^2 + dy3^2)^(3/2)));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           gr*m2*((dy3^2*sin((dx3^2 + dy3^2)^(1/2)/d)*(L0/2 - dL3)*((dy2*cos((dx1^2 + dy1^2)^(1/2)/d)*sin((dx2^2 + dy2^2)^(1/2)/d))/(dx2^2 + dy2^2)^(1/2) + (dy1*sin((dx1^2 + dy1^2)^(1/2)/d)*(dx2^2 + dy2^2*cos((dx2^2 + dy2^2)^(1/2)/d)))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)) + (dx1*dx2*dy2*sin((dx1^2 + dy1^2)^(1/2)/d)*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2))))/(dx3^2 + dy3^2)^(3/2) - (d*(cos((dx3^2 + dy3^2)^(1/2)/d) - 1)*(L0/2 - dL3)*((dy2*cos((dx1^2 + dy1^2)^(1/2)/d)*sin((dx2^2 + dy2^2)^(1/2)/d))/(dx2^2 + dy2^2)^(1/2) + (dy1*sin((dx1^2 + dy1^2)^(1/2)/d)*(dx2^2 + dy2^2*cos((dx2^2 + dy2^2)^(1/2)/d)))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)) + (dx1*dx2*dy2*sin((dx1^2 + dy1^2)^(1/2)/d)*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2))))/(dx3^2 + dy3^2) + (2*d*dy3^2*(cos((dx3^2 + dy3^2)^(1/2)/d) - 1)*(L0/2 - dL3)*((dy2*cos((dx1^2 + dy1^2)^(1/2)/d)*sin((dx2^2 + dy2^2)^(1/2)/d))/(dx2^2 + dy2^2)^(1/2) + (dy1*sin((dx1^2 + dy1^2)^(1/2)/d)*(dx2^2 + dy2^2*cos((dx2^2 + dy2^2)^(1/2)/d)))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)) + (dx1*dx2*dy2*sin((dx1^2 + dy1^2)^(1/2)/d)*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2))))/(dx3^2 + dy3^2)^2 + (dx3*dy3*sin((dx3^2 + dy3^2)^(1/2)/d)*(L0/2 - dL3)*((dx2*cos((dx1^2 + dy1^2)^(1/2)/d)*sin((dx2^2 + dy2^2)^(1/2)/d))/(dx2^2 + dy2^2)^(1/2) + (dx1*sin((dx1^2 + dy1^2)^(1/2)/d)*(dy2^2 + dx2^2*cos((dx2^2 + dy2^2)^(1/2)/d)))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)) + (dx2*dy1*dy2*sin((dx1^2 + dy1^2)^(1/2)/d)*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2))))/(dx3^2 + dy3^2)^(3/2) + (2*d*dx3*dy3*(cos((dx3^2 + dy3^2)^(1/2)/d) - 1)*(L0/2 - dL3)*((dx2*cos((dx1^2 + dy1^2)^(1/2)/d)*sin((dx2^2 + dy2^2)^(1/2)/d))/(dx2^2 + dy2^2)^(1/2) + (dx1*sin((dx1^2 + dy1^2)^(1/2)/d)*(dy2^2 + dx2^2*cos((dx2^2 + dy2^2)^(1/2)/d)))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)) + (dx2*dy1*dy2*sin((dx1^2 + dy1^2)^(1/2)/d)*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2))))/(dx3^2 + dy3^2)^2 + (dy3*cos((dx3^2 + dy3^2)^(1/2)/d)*(L0/2 - dL3)*(dx1*dx2*sin((dx1^2 + dy1^2)^(1/2)/d)*sin((dx2^2 + dy2^2)^(1/2)/d) - cos((dx1^2 + dy1^2)^(1/2)/d)*cos((dx2^2 + dy2^2)^(1/2)/d)*(dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)^(1/2) + dy1*dy2*sin((dx1^2 + dy1^2)^(1/2)/d)*sin((dx2^2 + dy2^2)^(1/2)/d)))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)^(1/2)*(dx3^2 + dy3^2)) - (d*dy3*sin((dx3^2 + dy3^2)^(1/2)/d)*(L0/2 - dL3)*(dx1*dx2*sin((dx1^2 + dy1^2)^(1/2)/d)*sin((dx2^2 + dy2^2)^(1/2)/d) - cos((dx1^2 + dy1^2)^(1/2)/d)*cos((dx2^2 + dy2^2)^(1/2)/d)*(dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)^(1/2) + dy1*dy2*sin((dx1^2 + dy1^2)^(1/2)/d)*sin((dx2^2 + dy2^2)^(1/2)/d)))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)^(1/2)*(dx3^2 + dy3^2)^(3/2)));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              gr*m2*((d*dx3*(cos((dx3^2 + dy3^2)^(1/2)/d) - 1)*((dx2*cos((dx1^2 + dy1^2)^(1/2)/d)*sin((dx2^2 + dy2^2)^(1/2)/d))/(dx2^2 + dy2^2)^(1/2) + (dx1*sin((dx1^2 + dy1^2)^(1/2)/d)*(dy2^2 + dx2^2*cos((dx2^2 + dy2^2)^(1/2)/d)))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)) + (dx2*dy1*dy2*sin((dx1^2 + dy1^2)^(1/2)/d)*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2))))/(dx3^2 + dy3^2) + (d*dy3*(cos((dx3^2 + dy3^2)^(1/2)/d) - 1)*((dy2*cos((dx1^2 + dy1^2)^(1/2)/d)*sin((dx2^2 + dy2^2)^(1/2)/d))/(dx2^2 + dy2^2)^(1/2) + (dy1*sin((dx1^2 + dy1^2)^(1/2)/d)*(dx2^2 + dy2^2*cos((dx2^2 + dy2^2)^(1/2)/d)))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)) + (dx1*dx2*dy2*sin((dx1^2 + dy1^2)^(1/2)/d)*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2))))/(dx3^2 + dy3^2) - (d*sin((dx3^2 + dy3^2)^(1/2)/d)*(dx1*dx2*sin((dx1^2 + dy1^2)^(1/2)/d)*sin((dx2^2 + dy2^2)^(1/2)/d) - cos((dx1^2 + dy1^2)^(1/2)/d)*cos((dx2^2 + dy2^2)^(1/2)/d)*(dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)^(1/2) + dy1*dy2*sin((dx1^2 + dy1^2)^(1/2)/d)*sin((dx2^2 + dy2^2)^(1/2)/d)))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)^(1/2)*(dx3^2 + dy3^2)^(1/2)))]
