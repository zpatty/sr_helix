function [X,J,T_q,dJ] = PCC_jacobian(q,d,L0,qd) %#codegen

dx = q(1);
dy = q(2);
dL = q(3);
dx_dot = qd(1);
dy_dot = qd(2);
dL_dot = qd(3);
del = sqrt(dx^2 + dy^2);

if del < 10^-6
    T_q = [eye(3) [0;0;L0+dL]; 0 0 0 1];
    J = [(L0 + dL)/(2*d),               0, 0
                      0, (L0 + dL)/(2*d), 0;
                      0,               0, 1;
                      0,            -1/d, 0;
                    1/d,               0, 0;
                      0,               0, 0];
    dJ = [              dL_dot/(2*d),                               0, -dx_dot/(2*d)
                                 0,                    dL_dot/(2*d), -dy_dot/(2*d)
        (dx_dot*(L0 + dL))/(6*d^2), (L0*dy_dot + dL*dy_dot)/(6*d^2),             0
                                 0,                               0,             0
                                 0,                               0,             0
                    dy_dot/(2*d^2),                 -dx_dot/(2*d^2),             0];
else
    
    Rq = [1 + dx^2/del^2*(cos(del/d) - 1), dx*dy/del^2*(cos(del/d) - 1), -dx/del*sin(del/d);
    dx*dy/del^2*(cos(del/d) - 1), 1+dy^2/del^2*(cos(del/d) - 1), -dy/del*sin(del/d);
    dx/del*sin(del/d), dy/del*sin(del/d), cos(del/d)].';

    tq = d*(L0 + dL)/del^2*[dx*(1 - cos(del/d)); dy*(1 - cos(del/d)); del*sin(del/d)];
    
    T_q = [Rq tq; 0 0 0 1];
    J = [((dy^2 + dx^2*cos((dx^2 + dy^2)^(1/2)/d))*((dx^2*sin((dx^2 + dy^2)^(1/2)/d)*(L0 + dL))/(dx^2 + dy^2)^(3/2) - (d*(L0 + dL)*(cos((dx^2 + dy^2)^(1/2)/d) - 1))/(dx^2 + dy^2) + (2*d*dx^2*(L0 + dL)*(cos((dx^2 + dy^2)^(1/2)/d) - 1))/(dx^2 + dy^2)^2))/(dx^2 + dy^2) - (dx^2*sin((dx^2 + dy^2)^(1/2)/d)*(L0 + dL)*(cos((dx^2 + dy^2)^(1/2)/d)*(dx^2 + dy^2)^(1/2) - d*sin((dx^2 + dy^2)^(1/2)/d)))/(dx^2 + dy^2)^2 + (dx^2*dy^2*(L0 + dL)*(cos((dx^2 + dy^2)^(1/2)/d) - 1)*(sin((dx^2 + dy^2)^(1/2)/d)*(dx^2 + dy^2)^(1/2) - 2*d + 2*d*cos((dx^2 + dy^2)^(1/2)/d)))/(dx^2 + dy^2)^3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                0, (d*dx*(cos((dx^2 + dy^2)^(1/2)/d) - 1))/(dx^2 + dy^2);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               0, ((dx^2 + dy^2*cos((dx^2 + dy^2)^(1/2)/d))*((dy^2*sin((dx^2 + dy^2)^(1/2)/d)*(L0 + dL))/(dx^2 + dy^2)^(3/2) - (d*(L0 + dL)*(cos((dx^2 + dy^2)^(1/2)/d) - 1))/(dx^2 + dy^2) + (2*d*dy^2*(L0 + dL)*(cos((dx^2 + dy^2)^(1/2)/d) - 1))/(dx^2 + dy^2)^2))/(dx^2 + dy^2) - (dy^2*sin((dx^2 + dy^2)^(1/2)/d)*(L0 + dL)*(cos((dx^2 + dy^2)^(1/2)/d)*(dx^2 + dy^2)^(1/2) - d*sin((dx^2 + dy^2)^(1/2)/d)))/(dx^2 + dy^2)^2 + (dx^2*dy^2*(L0 + dL)*(cos((dx^2 + dy^2)^(1/2)/d) - 1)*(sin((dx^2 + dy^2)^(1/2)/d)*(dx^2 + dy^2)^(1/2) - 2*d + 2*d*cos((dx^2 + dy^2)^(1/2)/d)))/(dx^2 + dy^2)^3, (d*dy*(cos((dx^2 + dy^2)^(1/2)/d) - 1))/(dx^2 + dy^2);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                           (dx*(L0 + dL)*((dx^2 + dy^2)^(3/2) - d*sin((dx^2 + dy^2)^(1/2)/d)*(dx^2 + dy^2)))/(dx^2 + dy^2)^(5/2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                            (dy*(L0 + dL)*((dx^2 + dy^2)^(3/2) - d*sin((dx^2 + dy^2)^(1/2)/d)*(dx^2 + dy^2)))/(dx^2 + dy^2)^(5/2),    (d*sin((dx^2 + dy^2)^(1/2)/d))/(dx^2 + dy^2)^(1/2);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           -(dx*dy*((dx^2 + dy^2)^(1/2) - d*sin((dx^2 + dy^2)^(1/2)/d)))/(d*(dx^2 + dy^2)^(3/2)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          -(dy^2*(dx^2 + dy^2)^(1/2) + d*dx^2*sin((dx^2 + dy^2)^(1/2)/d))/(d*(dx^2 + dy^2)^(3/2)),                                                     0;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          (dx^2*(dx^2 + dy^2)^(1/2) + d*dy^2*sin((dx^2 + dy^2)^(1/2)/d))/(d*(dx^2 + dy^2)^(3/2)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             (dx*dy*((dx^2 + dy^2)^(1/2) - d*sin((dx^2 + dy^2)^(1/2)/d)))/(d*(dx^2 + dy^2)^(3/2)),                                                     0;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            -(dy*(cos((dx^2 + dy^2)^(1/2)/d) - 1))/(dx^2 + dy^2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              (dx*(cos((dx^2 + dy^2)^(1/2)/d) - 1))/(dx^2 + dy^2),                                                     0];
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
%     J = [                                                       -(d*(L0 + dL)*(cos(del/d)*dx^2 + dy^2)*(cos(del/d) - 1))/del^4,                                                -(d*dx*dy*(L0 + dL)*(cos(del/d) - 1)^2)/del^4, - (d*dx*sin(del/d)^2)/del^2 - (d*dx*dy^2*(cos(del/d) - 1)^2)/del^4 - (d*dx*(cos(del/d)*dx^2 + dy^2)*(cos(del/d) - 1))/del^4;
%                                                                                 -(d*dx*dy*(L0 + dL)*(cos(del/d) - 1)^2)/del^4,                               -(d*(L0 + dL)*(dx^2 + cos(del/d)*dy^2)*(cos(del/d) - 1))/del^4,   (d*dy*sin(del/d)^2)/del^2 - (d*dx^2*dy*(cos(del/d) - 1)^2)/del^4 - (d*dy*(dx^2 + cos(del/d)*dy^2)*(cos(del/d) - 1))/del^4;
%                                                                           -(d*dx*sin(del/d)*(L0 + dL)*(cos(del/d) - 1))/del^3,                                           (d*dy*sin(del/d)*(L0 + dL)*(cos(del/d) - 1))/del^3,                                   (d*sin(del/d)*(del^2*cos(del/d) - dx^2*cos(del/d) + dy^2*cos(del/d) + dx^2 - dy^2))/del^3;
%                                                                                     (dx*dy*sin(del/d)*(cos(del/d) - 1))/del^3, -(sin(del/d)*(del^2*cos(del/d) - dx^2*cos(del/d) + 2*dy^2*cos(del/d) + dx^2 - 2*dy^2))/del^3,                                                                                                                           0;
%                                                                                   (sin(del/d)*(cos(del/d)*dx^2 + dy^2))/del^3,                                                    (dx*dy*sin(del/d)*(cos(del/d) - 1))/del^3,                                                                                                                           0;
%         (dy*(dx^2 + cos(del/d)*dy^2)*(cos(del/d) - 1))/del^4 - (dy*sin(del/d)^2)/del^2 + (2*dx^2*dy*(cos(del/d) - 1)^2)/del^4,                                         (dx*(dx^2 + cos(del/d)*dy^2)*(cos(del/d) - 1))/del^4,                                                                                                                           0];
      dJ = [((dy^2 + dx^2*cos((dx^2 + dy^2)^(1/2)/d))*((sin((dx^2 + dy^2)^(1/2)/d)*(L0 + dL)*(2*dx*dx_dot + 2*dy*dy_dot))/(2*(dx^2 + dy^2)^(3/2)) - (d*dL_dot*(cos((dx^2 + dy^2)^(1/2)/d) - 1))/(dx^2 + dy^2) + (dL_dot*dx^2*sin((dx^2 + dy^2)^(1/2)/d))/(dx^2 + dy^2)^(3/2) - (5*dx^2*sin((dx^2 + dy^2)^(1/2)/d)*(L0 + dL)*(2*dx*dx_dot + 2*dy*dy_dot))/(2*(dx^2 + dy^2)^(5/2)) + (2*dx*dx_dot*sin((dx^2 + dy^2)^(1/2)/d)*(L0 + dL))/(dx^2 + dy^2)^(3/2) + (2*d*dL_dot*dx^2*(cos((dx^2 + dy^2)^(1/2)/d) - 1))/(dx^2 + dy^2)^2 + (d*(L0 + dL)*(cos((dx^2 + dy^2)^(1/2)/d) - 1)*(2*dx*dx_dot + 2*dy*dy_dot))/(dx^2 + dy^2)^2 + (4*d*dx*dx_dot*(L0 + dL)*(cos((dx^2 + dy^2)^(1/2)/d) - 1))/(dx^2 + dy^2)^2 - (4*d*dx^2*(L0 + dL)*(cos((dx^2 + dy^2)^(1/2)/d) - 1)*(2*dx*dx_dot + 2*dy*dy_dot))/(dx^2 + dy^2)^3 + (dx^2*cos((dx^2 + dy^2)^(1/2)/d)*(L0 + dL)*(2*dx*dx_dot + 2*dy*dy_dot))/(2*d*(dx^2 + dy^2)^2)))/(dx^2 + dy^2) + (((dx^2*sin((dx^2 + dy^2)^(1/2)/d)*(L0 + dL))/(dx^2 + dy^2)^(3/2) - (d*(L0 + dL)*(cos((dx^2 + dy^2)^(1/2)/d) - 1))/(dx^2 + dy^2) + (2*d*dx^2*(L0 + dL)*(cos((dx^2 + dy^2)^(1/2)/d) - 1))/(dx^2 + dy^2)^2)*(2*dy*dy_dot + 2*dx*dx_dot*cos((dx^2 + dy^2)^(1/2)/d) - (dx^2*sin((dx^2 + dy^2)^(1/2)/d)*(2*dx*dx_dot + 2*dy*dy_dot))/(2*d*(dx^2 + dy^2)^(1/2))))/(dx^2 + dy^2) - ((dy^2 + dx^2*cos((dx^2 + dy^2)^(1/2)/d))*(2*dx*dx_dot + 2*dy*dy_dot)*((dx^2*sin((dx^2 + dy^2)^(1/2)/d)*(L0 + dL))/(dx^2 + dy^2)^(3/2) - (d*(L0 + dL)*(cos((dx^2 + dy^2)^(1/2)/d) - 1))/(dx^2 + dy^2) + (2*d*dx^2*(L0 + dL)*(cos((dx^2 + dy^2)^(1/2)/d) - 1))/(dx^2 + dy^2)^2))/(dx^2 + dy^2)^2 - (dL_dot*dx^2*sin((dx^2 + dy^2)^(1/2)/d)*(cos((dx^2 + dy^2)^(1/2)/d)*(dx^2 + dy^2)^(1/2) - d*sin((dx^2 + dy^2)^(1/2)/d)))/(dx^2 + dy^2)^2 + (dx^2*sin((dx^2 + dy^2)^(1/2)/d)^2*(L0 + dL)*(2*dx*dx_dot + 2*dy*dy_dot))/(2*d*(dx^2 + dy^2)^2) + (2*dx^2*sin((dx^2 + dy^2)^(1/2)/d)*(L0 + dL)*(cos((dx^2 + dy^2)^(1/2)/d)*(dx^2 + dy^2)^(1/2) - d*sin((dx^2 + dy^2)^(1/2)/d))*(2*dx*dx_dot + 2*dy*dy_dot))/(dx^2 + dy^2)^3 - (dx^2*dy^2*(L0 + dL)*(cos((dx^2 + dy^2)^(1/2)/d) - 1)*((sin((dx^2 + dy^2)^(1/2)/d)*(2*dx*dx_dot + 2*dy*dy_dot))/(2*(dx^2 + dy^2)^(1/2)) - (cos((dx^2 + dy^2)^(1/2)/d)*(2*dx*dx_dot + 2*dy*dy_dot))/(2*d)))/(dx^2 + dy^2)^3 - (2*dx*dx_dot*sin((dx^2 + dy^2)^(1/2)/d)*(L0 + dL)*(cos((dx^2 + dy^2)^(1/2)/d)*(dx^2 + dy^2)^(1/2) - d*sin((dx^2 + dy^2)^(1/2)/d)))/(dx^2 + dy^2)^2 + (dL_dot*dx^2*dy^2*(cos((dx^2 + dy^2)^(1/2)/d) - 1)*(sin((dx^2 + dy^2)^(1/2)/d)*(dx^2 + dy^2)^(1/2) - 2*d + 2*d*cos((dx^2 + dy^2)^(1/2)/d)))/(dx^2 + dy^2)^3 - (dx^2*cos((dx^2 + dy^2)^(1/2)/d)*(L0 + dL)*(cos((dx^2 + dy^2)^(1/2)/d)*(dx^2 + dy^2)^(1/2) - d*sin((dx^2 + dy^2)^(1/2)/d))*(2*dx*dx_dot + 2*dy*dy_dot))/(2*d*(dx^2 + dy^2)^(5/2)) - (3*dx^2*dy^2*(L0 + dL)*(cos((dx^2 + dy^2)^(1/2)/d) - 1)*(2*dx*dx_dot + 2*dy*dy_dot)*(sin((dx^2 + dy^2)^(1/2)/d)*(dx^2 + dy^2)^(1/2) - 2*d + 2*d*cos((dx^2 + dy^2)^(1/2)/d)))/(dx^2 + dy^2)^4 + (2*dx*dx_dot*dy^2*(L0 + dL)*(cos((dx^2 + dy^2)^(1/2)/d) - 1)*(sin((dx^2 + dy^2)^(1/2)/d)*(dx^2 + dy^2)^(1/2) - 2*d + 2*d*cos((dx^2 + dy^2)^(1/2)/d)))/(dx^2 + dy^2)^3 + (2*dx^2*dy*dy_dot*(L0 + dL)*(cos((dx^2 + dy^2)^(1/2)/d) - 1)*(sin((dx^2 + dy^2)^(1/2)/d)*(dx^2 + dy^2)^(1/2) - 2*d + 2*d*cos((dx^2 + dy^2)^(1/2)/d)))/(dx^2 + dy^2)^3 - (dx^2*dy^2*sin((dx^2 + dy^2)^(1/2)/d)*(L0 + dL)*(2*dx*dx_dot + 2*dy*dy_dot)*(sin((dx^2 + dy^2)^(1/2)/d)*(dx^2 + dy^2)^(1/2) - 2*d + 2*d*cos((dx^2 + dy^2)^(1/2)/d)))/(2*d*(dx^2 + dy^2)^(7/2)), 0, (d*dx_dot*(cos((dx^2 + dy^2)^(1/2)/d) - 1))/(dx^2 + dy^2) - (dx*sin((dx^2 + dy^2)^(1/2)/d)*(2*dx*dx_dot + 2*dy*dy_dot))/(2*(dx^2 + dy^2)^(3/2)) - (d*dx*(cos((dx^2 + dy^2)^(1/2)/d) - 1)*(2*dx*dx_dot + 2*dy*dy_dot))/(dx^2 + dy^2)^2; 0, ((dx^2 + dy^2*cos((dx^2 + dy^2)^(1/2)/d))*((sin((dx^2 + dy^2)^(1/2)/d)*(L0 + dL)*(2*dx*dx_dot + 2*dy*dy_dot))/(2*(dx^2 + dy^2)^(3/2)) - (d*dL_dot*(cos((dx^2 + dy^2)^(1/2)/d) - 1))/(dx^2 + dy^2) + (dL_dot*dy^2*sin((dx^2 + dy^2)^(1/2)/d))/(dx^2 + dy^2)^(3/2) - (5*dy^2*sin((dx^2 + dy^2)^(1/2)/d)*(L0 + dL)*(2*dx*dx_dot + 2*dy*dy_dot))/(2*(dx^2 + dy^2)^(5/2)) + (2*dy*dy_dot*sin((dx^2 + dy^2)^(1/2)/d)*(L0 + dL))/(dx^2 + dy^2)^(3/2) + (2*d*dL_dot*dy^2*(cos((dx^2 + dy^2)^(1/2)/d) - 1))/(dx^2 + dy^2)^2 + (d*(L0 + dL)*(cos((dx^2 + dy^2)^(1/2)/d) - 1)*(2*dx*dx_dot + 2*dy*dy_dot))/(dx^2 + dy^2)^2 + (4*d*dy*dy_dot*(L0 + dL)*(cos((dx^2 + dy^2)^(1/2)/d) - 1))/(dx^2 + dy^2)^2 - (4*d*dy^2*(L0 + dL)*(cos((dx^2 + dy^2)^(1/2)/d) - 1)*(2*dx*dx_dot + 2*dy*dy_dot))/(dx^2 + dy^2)^3 + (dy^2*cos((dx^2 + dy^2)^(1/2)/d)*(L0 + dL)*(2*dx*dx_dot + 2*dy*dy_dot))/(2*d*(dx^2 + dy^2)^2)))/(dx^2 + dy^2) + (((dy^2*sin((dx^2 + dy^2)^(1/2)/d)*(L0 + dL))/(dx^2 + dy^2)^(3/2) - (d*(L0 + dL)*(cos((dx^2 + dy^2)^(1/2)/d) - 1))/(dx^2 + dy^2) + (2*d*dy^2*(L0 + dL)*(cos((dx^2 + dy^2)^(1/2)/d) - 1))/(dx^2 + dy^2)^2)*(2*dx*dx_dot + 2*dy*dy_dot*cos((dx^2 + dy^2)^(1/2)/d) - (dy^2*sin((dx^2 + dy^2)^(1/2)/d)*(2*dx*dx_dot + 2*dy*dy_dot))/(2*d*(dx^2 + dy^2)^(1/2))))/(dx^2 + dy^2) - ((dx^2 + dy^2*cos((dx^2 + dy^2)^(1/2)/d))*(2*dx*dx_dot + 2*dy*dy_dot)*((dy^2*sin((dx^2 + dy^2)^(1/2)/d)*(L0 + dL))/(dx^2 + dy^2)^(3/2) - (d*(L0 + dL)*(cos((dx^2 + dy^2)^(1/2)/d) - 1))/(dx^2 + dy^2) + (2*d*dy^2*(L0 + dL)*(cos((dx^2 + dy^2)^(1/2)/d) - 1))/(dx^2 + dy^2)^2))/(dx^2 + dy^2)^2 - (dL_dot*dy^2*sin((dx^2 + dy^2)^(1/2)/d)*(cos((dx^2 + dy^2)^(1/2)/d)*(dx^2 + dy^2)^(1/2) - d*sin((dx^2 + dy^2)^(1/2)/d)))/(dx^2 + dy^2)^2 + (dy^2*sin((dx^2 + dy^2)^(1/2)/d)^2*(L0 + dL)*(2*dx*dx_dot + 2*dy*dy_dot))/(2*d*(dx^2 + dy^2)^2) + (2*dy^2*sin((dx^2 + dy^2)^(1/2)/d)*(L0 + dL)*(cos((dx^2 + dy^2)^(1/2)/d)*(dx^2 + dy^2)^(1/2) - d*sin((dx^2 + dy^2)^(1/2)/d))*(2*dx*dx_dot + 2*dy*dy_dot))/(dx^2 + dy^2)^3 - (dx^2*dy^2*(L0 + dL)*(cos((dx^2 + dy^2)^(1/2)/d) - 1)*((sin((dx^2 + dy^2)^(1/2)/d)*(2*dx*dx_dot + 2*dy*dy_dot))/(2*(dx^2 + dy^2)^(1/2)) - (cos((dx^2 + dy^2)^(1/2)/d)*(2*dx*dx_dot + 2*dy*dy_dot))/(2*d)))/(dx^2 + dy^2)^3 - (2*dy*dy_dot*sin((dx^2 + dy^2)^(1/2)/d)*(L0 + dL)*(cos((dx^2 + dy^2)^(1/2)/d)*(dx^2 + dy^2)^(1/2) - d*sin((dx^2 + dy^2)^(1/2)/d)))/(dx^2 + dy^2)^2 + (dL_dot*dx^2*dy^2*(cos((dx^2 + dy^2)^(1/2)/d) - 1)*(sin((dx^2 + dy^2)^(1/2)/d)*(dx^2 + dy^2)^(1/2) - 2*d + 2*d*cos((dx^2 + dy^2)^(1/2)/d)))/(dx^2 + dy^2)^3 - (dy^2*cos((dx^2 + dy^2)^(1/2)/d)*(L0 + dL)*(cos((dx^2 + dy^2)^(1/2)/d)*(dx^2 + dy^2)^(1/2) - d*sin((dx^2 + dy^2)^(1/2)/d))*(2*dx*dx_dot + 2*dy*dy_dot))/(2*d*(dx^2 + dy^2)^(5/2)) - (3*dx^2*dy^2*(L0 + dL)*(cos((dx^2 + dy^2)^(1/2)/d) - 1)*(2*dx*dx_dot + 2*dy*dy_dot)*(sin((dx^2 + dy^2)^(1/2)/d)*(dx^2 + dy^2)^(1/2) - 2*d + 2*d*cos((dx^2 + dy^2)^(1/2)/d)))/(dx^2 + dy^2)^4 + (2*dx*dx_dot*dy^2*(L0 + dL)*(cos((dx^2 + dy^2)^(1/2)/d) - 1)*(sin((dx^2 + dy^2)^(1/2)/d)*(dx^2 + dy^2)^(1/2) - 2*d + 2*d*cos((dx^2 + dy^2)^(1/2)/d)))/(dx^2 + dy^2)^3 + (2*dx^2*dy*dy_dot*(L0 + dL)*(cos((dx^2 + dy^2)^(1/2)/d) - 1)*(sin((dx^2 + dy^2)^(1/2)/d)*(dx^2 + dy^2)^(1/2) - 2*d + 2*d*cos((dx^2 + dy^2)^(1/2)/d)))/(dx^2 + dy^2)^3 - (dx^2*dy^2*sin((dx^2 + dy^2)^(1/2)/d)*(L0 + dL)*(2*dx*dx_dot + 2*dy*dy_dot)*(sin((dx^2 + dy^2)^(1/2)/d)*(dx^2 + dy^2)^(1/2) - 2*d + 2*d*cos((dx^2 + dy^2)^(1/2)/d)))/(2*d*(dx^2 + dy^2)^(7/2)), (d*dy_dot*(cos((dx^2 + dy^2)^(1/2)/d) - 1))/(dx^2 + dy^2) - (dy*sin((dx^2 + dy^2)^(1/2)/d)*(2*dx*dx_dot + 2*dy*dy_dot))/(2*(dx^2 + dy^2)^(3/2)) - (d*dy*(cos((dx^2 + dy^2)^(1/2)/d) - 1)*(2*dx*dx_dot + 2*dy*dy_dot))/(dx^2 + dy^2)^2; (dx_dot*(L0 + dL)*((dx^2 + dy^2)^(3/2) - d*sin((dx^2 + dy^2)^(1/2)/d)*(dx^2 + dy^2)))/(dx^2 + dy^2)^(5/2) - (dx*(L0 + dL)*((cos((dx^2 + dy^2)^(1/2)/d)*(2*dx*dx_dot + 2*dy*dy_dot)*(dx^2 + dy^2)^(1/2))/2 - (3*(2*dx*dx_dot + 2*dy*dy_dot)*(dx^2 + dy^2)^(1/2))/2 + d*sin((dx^2 + dy^2)^(1/2)/d)*(2*dx*dx_dot + 2*dy*dy_dot)))/(dx^2 + dy^2)^(5/2) + (dL_dot*dx*((dx^2 + dy^2)^(3/2) - d*sin((dx^2 + dy^2)^(1/2)/d)*(dx^2 + dy^2)))/(dx^2 + dy^2)^(5/2) - (5*dx*(L0 + dL)*((dx^2 + dy^2)^(3/2) - d*sin((dx^2 + dy^2)^(1/2)/d)*(dx^2 + dy^2))*(2*dx*dx_dot + 2*dy*dy_dot))/(2*(dx^2 + dy^2)^(7/2)), (dy_dot*(L0 + dL)*((dx^2 + dy^2)^(3/2) - d*sin((dx^2 + dy^2)^(1/2)/d)*(dx^2 + dy^2)))/(dx^2 + dy^2)^(5/2) - (dy*(L0 + dL)*((cos((dx^2 + dy^2)^(1/2)/d)*(2*dx*dx_dot + 2*dy*dy_dot)*(dx^2 + dy^2)^(1/2))/2 - (3*(2*dx*dx_dot + 2*dy*dy_dot)*(dx^2 + dy^2)^(1/2))/2 + d*sin((dx^2 + dy^2)^(1/2)/d)*(2*dx*dx_dot + 2*dy*dy_dot)))/(dx^2 + dy^2)^(5/2) + (dL_dot*dy*((dx^2 + dy^2)^(3/2) - d*sin((dx^2 + dy^2)^(1/2)/d)*(dx^2 + dy^2)))/(dx^2 + dy^2)^(5/2) - (5*dy*(L0 + dL)*((dx^2 + dy^2)^(3/2) - d*sin((dx^2 + dy^2)^(1/2)/d)*(dx^2 + dy^2))*(2*dx*dx_dot + 2*dy*dy_dot))/(2*(dx^2 + dy^2)^(7/2)), (cos((dx^2 + dy^2)^(1/2)/d)*(2*dx*dx_dot + 2*dy*dy_dot))/(2*(dx^2 + dy^2)) - (d*sin((dx^2 + dy^2)^(1/2)/d)*(2*dx*dx_dot + 2*dy*dy_dot))/(2*(dx^2 + dy^2)^(3/2)); (3*dx*dy*((dx^2 + dy^2)^(1/2) - d*sin((dx^2 + dy^2)^(1/2)/d))*(2*dx*dx_dot + 2*dy*dy_dot))/(2*d*(dx^2 + dy^2)^(5/2)) - (dx*dy_dot*((dx^2 + dy^2)^(1/2) - d*sin((dx^2 + dy^2)^(1/2)/d)))/(d*(dx^2 + dy^2)^(3/2)) - (dx_dot*dy*((dx^2 + dy^2)^(1/2) - d*sin((dx^2 + dy^2)^(1/2)/d)))/(d*(dx^2 + dy^2)^(3/2)) - (dx*dy*((2*dx*dx_dot + 2*dy*dy_dot)/(2*(dx^2 + dy^2)^(1/2)) - (cos((dx^2 + dy^2)^(1/2)/d)*(2*dx*dx_dot + 2*dy*dy_dot))/(2*(dx^2 + dy^2)^(1/2))))/(d*(dx^2 + dy^2)^(3/2)), (3*(dy^2*(dx^2 + dy^2)^(1/2) + d*dx^2*sin((dx^2 + dy^2)^(1/2)/d))*(2*dx*dx_dot + 2*dy*dy_dot))/(2*d*(dx^2 + dy^2)^(5/2)) - ((dy^2*(2*dx*dx_dot + 2*dy*dy_dot))/(2*(dx^2 + dy^2)^(1/2)) + 2*dy*dy_dot*(dx^2 + dy^2)^(1/2) + 2*d*dx*dx_dot*sin((dx^2 + dy^2)^(1/2)/d) + (dx^2*cos((dx^2 + dy^2)^(1/2)/d)*(2*dx*dx_dot + 2*dy*dy_dot))/(2*(dx^2 + dy^2)^(1/2)))/(d*(dx^2 + dy^2)^(3/2)), 0; ((dx^2*(2*dx*dx_dot + 2*dy*dy_dot))/(2*(dx^2 + dy^2)^(1/2)) + 2*dx*dx_dot*(dx^2 + dy^2)^(1/2) + 2*d*dy*dy_dot*sin((dx^2 + dy^2)^(1/2)/d) + (dy^2*cos((dx^2 + dy^2)^(1/2)/d)*(2*dx*dx_dot + 2*dy*dy_dot))/(2*(dx^2 + dy^2)^(1/2)))/(d*(dx^2 + dy^2)^(3/2)) - (3*(dx^2*(dx^2 + dy^2)^(1/2) + d*dy^2*sin((dx^2 + dy^2)^(1/2)/d))*(2*dx*dx_dot + 2*dy*dy_dot))/(2*d*(dx^2 + dy^2)^(5/2)), (dx*dy*((2*dx*dx_dot + 2*dy*dy_dot)/(2*(dx^2 + dy^2)^(1/2)) - (cos((dx^2 + dy^2)^(1/2)/d)*(2*dx*dx_dot + 2*dy*dy_dot))/(2*(dx^2 + dy^2)^(1/2))))/(d*(dx^2 + dy^2)^(3/2)) + (dx*dy_dot*((dx^2 + dy^2)^(1/2) - d*sin((dx^2 + dy^2)^(1/2)/d)))/(d*(dx^2 + dy^2)^(3/2)) + (dx_dot*dy*((dx^2 + dy^2)^(1/2) - d*sin((dx^2 + dy^2)^(1/2)/d)))/(d*(dx^2 + dy^2)^(3/2)) - (3*dx*dy*((dx^2 + dy^2)^(1/2) - d*sin((dx^2 + dy^2)^(1/2)/d))*(2*dx*dx_dot + 2*dy*dy_dot))/(2*d*(dx^2 + dy^2)^(5/2)), 0; (dy*(cos((dx^2 + dy^2)^(1/2)/d) - 1)*(2*dx*dx_dot + 2*dy*dy_dot))/(dx^2 + dy^2)^2 - (dy_dot*(cos((dx^2 + dy^2)^(1/2)/d) - 1))/(dx^2 + dy^2) + (dy*sin((dx^2 + dy^2)^(1/2)/d)*(2*dx*dx_dot + 2*dy*dy_dot))/(2*d*(dx^2 + dy^2)^(3/2)), (dx_dot*(cos((dx^2 + dy^2)^(1/2)/d) - 1))/(dx^2 + dy^2) - (dx*(cos((dx^2 + dy^2)^(1/2)/d) - 1)*(2*dx*dx_dot + 2*dy*dy_dot))/(dx^2 + dy^2)^2 - (dx*sin((dx^2 + dy^2)^(1/2)/d)*(2*dx*dx_dot + 2*dy*dy_dot))/(2*d*(dx^2 + dy^2)^(3/2)), 0];

end
X = adj_calc(T_q,1);
end
                                  